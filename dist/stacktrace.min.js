(function(root,factory){"use strict";if(typeof define==="function"&&define.amd){define([],factory)}else if(typeof exports==="object"){module.exports=factory()}else{root.StackFrame=factory()}})(this,function(){"use strict";function _isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function StackFrame(functionName,args,fileName,lineNumber,columnNumber){if(functionName!==undefined){this.setFunctionName(functionName)}if(args!==undefined){this.setArgs(args)}if(fileName!==undefined){this.setFileName(fileName)}if(lineNumber!==undefined){this.setLineNumber(lineNumber)}if(columnNumber!==undefined){this.setColumnNumber(columnNumber)}}StackFrame.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(v){this.functionName=String(v)},getArgs:function(){return this.args},setArgs:function(v){if(Object.prototype.toString.call(v)!=="[object Array]"){throw new TypeError("Args must be an Array")}this.args=v},getFileName:function(){return this.fileName},setFileName:function(v){this.fileName=String(v)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(v){if(!_isNumber(v)){throw new TypeError("Line Number must be a Number")}this.lineNumber=Number(v)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(v){if(!_isNumber(v)){throw new TypeError("Column Number must be a Number")}this.columnNumber=Number(v)},toString:function(){var functionName=this.getFunctionName()||"{anonymous}";var args="("+(this.getArgs()||[]).join(",")+")";var fileName=this.getFileName()?"@"+this.getFileName():"";var lineNumber=_isNumber(this.getLineNumber())?":"+this.getLineNumber():"";var columnNumber=_isNumber(this.getColumnNumber())?":"+this.getColumnNumber():"";return functionName+args+fileName+lineNumber+columnNumber}};return StackFrame});(function(root,factory){"use strict";if(typeof define==="function"&&define.amd){define("error-stack-parser",["stackframe"],factory)}else if(typeof exports==="object"){module.exports=factory(require("stackframe"))}else{root.ErrorStackParser=factory(root.StackFrame)}})(this,function ErrorStackParser(StackFrame){"use strict";var FIREFOX_SAFARI_STACK_REGEXP=/\S+\:\d+/;var CHROME_IE_STACK_REGEXP=/\s+at /;return{parse:function ErrorStackParser$$parse(error){if(typeof error.stacktrace!=="undefined"||typeof error["opera#sourceloc"]!=="undefined"){return this.parseOpera(error)}else if(error.stack&&error.stack.match(CHROME_IE_STACK_REGEXP)){return this.parseV8OrIE(error)}else if(error.stack&&error.stack.match(FIREFOX_SAFARI_STACK_REGEXP)){return this.parseFFOrSafari(error)}else{throw new Error("Cannot parse given Error object")}},extractLocation:function ErrorStackParser$$extractLocation(urlLike){var locationParts=urlLike.split(":");var lastNumber=locationParts.pop();var possibleNumber=locationParts[locationParts.length-1];if(!isNaN(parseFloat(possibleNumber))&&isFinite(possibleNumber)){var lineNumber=locationParts.pop();return[locationParts.join(":"),lineNumber,lastNumber]}else{return[locationParts.join(":"),lastNumber,undefined]}},parseV8OrIE:function ErrorStackParser$$parseV8OrIE(error){return error.stack.split("\n").slice(1).map(function(line){var tokens=line.replace(/^\s+/,"").split(/\s+/).slice(1);var locationParts=this.extractLocation(tokens.pop().replace(/[\(\)\s]/g,""));var functionName=!tokens[0]||tokens[0]==="Anonymous"?undefined:tokens[0];return new StackFrame(functionName,undefined,locationParts[0],locationParts[1],locationParts[2])},this)},parseFFOrSafari:function ErrorStackParser$$parseFFOrSafari(error){return error.stack.split("\n").filter(function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)},this).map(function(line){var tokens=line.split("@");var locationParts=this.extractLocation(tokens.pop());var functionName=tokens.shift()||undefined;return new StackFrame(functionName,undefined,locationParts[0],locationParts[1],locationParts[2])},this)},parseOpera:function ErrorStackParser$$parseOpera(e){if(!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length){return this.parseOpera9(e)}else if(!e.stack){return this.parseOpera10(e)}else{return this.parseOpera11(e)}},parseOpera9:function ErrorStackParser$$parseOpera9(e){var lineRE=/Line (\d+).*script (?:in )?(\S+)/i;var lines=e.message.split("\n");var result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(new StackFrame(undefined,undefined,match[2],match[1]))}}return result},parseOpera10:function ErrorStackParser$$parseOpera10(e){var lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var lines=e.stacktrace.split("\n");var result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(new StackFrame(match[3]||undefined,undefined,match[2],match[1]))}}return result},parseOpera11:function ErrorStackParser$$parseOpera11(error){return error.stack.split("\n").filter(function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)&&!line.match(/^Error created at/)},this).map(function(line){var tokens=line.split("@");var locationParts=this.extractLocation(tokens.pop());var functionCall=tokens.shift()||"";var functionName=functionCall.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||undefined;var argsRaw;if(functionCall.match(/\(([^\)]*)\)/)){argsRaw=functionCall.replace(/^[^\(]+\(([^\)]*)\)$/,"$1")}var args=argsRaw===undefined||argsRaw==="[arguments not available]"?undefined:argsRaw.split(",");return new StackFrame(functionName,args,locationParts[0],locationParts[1],locationParts[2])},this)}}});(function(root,factory){"use strict";if(typeof define==="function"&&define.amd){define("stack-generator",["stackframe"],factory)}else if(typeof exports==="object"){module.exports=factory(require("stackframe"))}else{root.StackGenerator=factory(root.StackFrame)}})(this,function(StackFrame){return{backtrace:function StackGenerator$$backtrace(opts){var stack=[];var maxStackSize=10;if(typeof opts==="object"&&typeof opts.maxStackSize==="number"){maxStackSize=opts.maxStackSize}var curr=arguments.callee;while(curr&&stack.length<maxStackSize){var args=[].slice.call(curr["arguments"]);if(/function(?:\s+([\w$]+))?\s*\(/.test(curr.toString())){stack.push(new StackFrame(RegExp.$1||undefined,args))}else{stack.push(new StackFrame(undefined,args))}try{curr=curr.caller}catch(e){break}}return stack}}});(function(){function r(a,b){n[l]=a;n[l+1]=b;l+=2;2===l&&A()}function s(a){return"function"===typeof a}function F(){return function(){process.nextTick(t)}}function G(){var a=0,b=new B(t),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function H(){var a=new MessageChannel;a.port1.onmessage=t;return function(){a.port2.postMessage(0)}}function I(){return function(){setTimeout(t,1)}}function t(){for(var a=0;a<l;a+=2)(0,n[a])(n[a+1]),n[a]=void 0,n[a+1]=void 0;l=0}function p(){}function J(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function K(a,b,c){r(function(a){var e=!1,f=J(c,b,function(c){e||(e=!0,b!==c?q(a,c):m(a,c))},function(b){e||(e=!0,g(a,b))});!e&&f&&(e=!0,g(a,f))},a)}function L(a,b){1===b.a?m(a,b.b):2===a.a?g(a,b.b):u(b,void 0,function(b){q(a,b)},function(b){g(a,b)})}function q(a,b){if(a===b)g(a,new TypeError("You cannot resolve a promise with itself"));else if("function"===typeof b||"object"===typeof b&&null!==b)if(b.constructor===a.constructor)L(a,b);else{var c;try{c=b.then}catch(d){v.error=d,c=v}c===v?g(a,v.error):void 0===c?m(a,b):s(c)?K(a,b,c):m(a,b)}else m(a,b)}function M(a){a.f&&a.f(a.b);x(a)}function m(a,b){void 0===a.a&&(a.b=b,a.a=1,0!==a.e.length&&r(x,a))}function g(a,b){void 0===a.a&&(a.a=2,a.b=b,r(M,a))}function u(a,b,c,d){var e=a.e,f=e.length;a.f=null;e[f]=b;e[f+1]=c;e[f+2]=d;0===f&&a.a&&r(x,a)}function x(a){var b=a.e,c=a.a;if(0!==b.length){for(var d,e,f=a.b,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?C(c,d,e,f):e(f);a.e.length=0}}function D(){this.error=null}function C(a,b,c,d){var e=s(c),f,k,h,l;if(e){try{f=c(d)}catch(n){y.error=n,f=y}f===y?(l=!0,k=f.error,f=null):h=!0;if(b===f){g(b,new TypeError("A promises callback cannot return that same promise."));return}}else f=d,h=!0;void 0===b.a&&(e&&h?q(b,f):l?g(b,k):1===a?m(b,f):2===a&&g(b,f))}function N(a,b){try{b(function(b){q(a,b)},function(b){g(a,b)})}catch(c){g(a,c)}}function k(a,b,c,d){this.n=a;this.c=new a(p,d);this.i=c;this.o(b)?(this.m=b,this.d=this.length=b.length,this.l(),0===this.length?m(this.c,this.b):(this.length=this.length||0,this.k(),0===this.d&&m(this.c,this.b))):g(this.c,this.p())}function h(a){O++;this.b=this.a=void 0;this.e=[];if(p!==a){if(!s(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof h))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");N(this,a)}}var E=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},l=0,w="undefined"!==typeof window?window:{},B=w.MutationObserver||w.WebKitMutationObserver,w="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,n=Array(1e3),A;A="undefined"!==typeof process&&"[object process]"==={}.toString.call(process)?F():B?G():w?H():I();var v=new D,y=new D;k.prototype.o=function(a){return E(a)};k.prototype.p=function(){return Error("Array Methods must be provided an Array")};k.prototype.l=function(){this.b=Array(this.length)};k.prototype.k=function(){for(var a=this.length,b=this.c,c=this.m,d=0;void 0===b.a&&d<a;d++)this.j(c[d],d)};k.prototype.j=function(a,b){var c=this.n;"object"===typeof a&&null!==a?a.constructor===c&&void 0!==a.a?(a.f=null,this.g(a.a,b,a.b)):this.q(c.resolve(a),b):(this.d--,this.b[b]=this.h(a))};k.prototype.g=function(a,b,c){var d=this.c;void 0===d.a&&(this.d--,this.i&&2===a?g(d,c):this.b[b]=this.h(c));0===this.d&&m(d,this.b)};k.prototype.h=function(a){return a};k.prototype.q=function(a,b){var c=this;u(a,void 0,function(a){c.g(1,b,a)},function(a){c.g(2,b,a)})};var O=0;h.all=function(a,b){return new k(this,a,!0,b).c};h.race=function(a,b){function c(a){q(e,a)}function d(a){g(e,a)}var e=new this(p,b);if(!E(a))return g(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,h=0;void 0===e.a&&h<f;h++)u(this.resolve(a[h]),void 0,c,d);return e};h.resolve=function(a,b){if(a&&"object"===typeof a&&a.constructor===this)return a;var c=new this(p,b);q(c,a);return c};h.reject=function(a,b){var c=new this(p,b);g(c,a);return c};h.prototype={constructor:h,then:function(a,b){var c=this.a;if(1===c&&!a||2===c&&!b)return this;var d=new this.constructor(p),e=this.b;if(c){var f=arguments[c-1];r(function(){C(c,d,f,e)})}else u(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}};var z={Promise:h,polyfill:function(){var a;a="undefined"!==typeof global?global:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;new a.Promise(function(a){b=a});return s(b)}()||(a.Promise=h)}};"function"===typeof define&&define.amd?define(function(){return z}):"undefined"!==typeof module&&module.exports?module.exports=z:"undefined"!==typeof this&&(this.ES6Promise=z)}).call(this);(function(root,factory){"use strict";if(typeof define==="function"&&define.amd){define("stacktrace-gps",["source-map","es6-promise"],factory)}else if(typeof exports==="object"){module.exports=factory(require("source-map/lib/source-map/source-map-consumer"),require("es6-promise"))}else{root.StackTraceGPS=factory(root.SourceMap,root.ES6Promise)}})(this,function(SourceMap,ES6Promise){"use strict";ES6Promise.polyfill();var Promise=ES6Promise.Promise;function _createXMLHTTPObject(){var xmlhttp;var XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();_createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp}catch(e){}}}function _xdr(url,callback,errback){var req=_createXMLHTTPObject();req.open("get",url);req.onerror=errback;req.onreadystatechange=function onreadystatechange(){if(req.readyState===4){if(req.status>=200&&req.status<400){return callback(req.responseText)}else{errback(new Error("Unable to retrieve "+url))}}};req.send()}function _findFunctionName(source,lineNumber,columnNumber){var reFunctionDeclaration=/function\s+([^(]*?)\s*\(([^)]*)\)/;var reFunctionExpression=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/;var reFunctionEvaluation=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/;var lines=source.split("\n");var code="",line,maxLines=Math.min(lineNumber,20),m,commentPos;for(var i=0;i<maxLines;++i){line=lines[lineNumber-i-1];commentPos=line.indexOf("//");if(commentPos>=0){line=line.substr(0,commentPos)}if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1]}m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1]}m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1]}}}return undefined}function _ensureSupportedEnvironment(){if(typeof Object.defineProperty!=="function"||typeof Object.create!=="function"){throw new Error("Unable to consume source maps in older browsers")}}function _ensureStackFrameIsLegit(stackframe){if(typeof stackframe!=="object"){throw new TypeError("Given StackFrame is not an object")}else if(typeof stackframe.fileName!=="string"){throw new TypeError("Given file name is not a String")}else if(typeof stackframe.lineNumber!=="number"||stackframe.lineNumber%1!==0||stackframe.lineNumber<1){throw new TypeError("Given line number must be a positive integer")}else if(typeof stackframe.columnNumber!=="number"||stackframe.columnNumber%1!==0||stackframe.columnNumber<0){throw new TypeError("Given column number must be a non-negative integer")}return true}function _findSourceMappingURL(source){var m=/\/\/[#@] ?sourceMappingURL=([^\s'"]+)$/.exec(source);if(m&&m[1]){return m[1]}else{throw new Error("sourceMappingURL not found")}}function _newLocationInfoFromSourceMap(rawSourceMap,args,lineNumber,columnNumber){var loc=new SourceMap.SourceMapConsumer(rawSourceMap).originalPositionFor({line:lineNumber,column:columnNumber});return new StackFrame(loc.name,args,loc.source,loc.line,loc.column)}return function StackTraceGPS(opts){if(!(this instanceof StackTraceGPS)){return new StackTraceGPS(opts)}opts=opts||{};this.sourceCache=opts.sourceCache||{};this._get=function _get(location){return new Promise(function(resolve,reject){if(this.sourceCache[location]){resolve(this.sourceCache[location])}else if(opts.offline){reject(new Error("Cannot make network requests in offline mode"))}else{_xdr(location,function(source){this.sourceCache[location]=source;resolve(source)}.bind(this),reject)}}.bind(this))};this.pinpoint=function StackTraceGPS$$pinpoint(stackframe){return this.getMappedLocation(stackframe).then(this.findFunctionName.bind(this))};this.findFunctionName=function StackTraceGPS$$findFunctionName(stackframe){return new Promise(function(resolve,reject){_ensureStackFrameIsLegit(stackframe);this._get(stackframe.fileName).then(function getSourceCallback(source){var guessedFunctionName=_findFunctionName(source,stackframe.lineNumber,stackframe.columnNumber);resolve(new StackFrame(guessedFunctionName,stackframe.args,stackframe.fileName,stackframe.lineNumber,stackframe.columnNumber))},reject)}.bind(this))};this.getMappedLocation=function StackTraceGPS$$getMappedLocation(stackframe){return new Promise(function(resolve,reject){_ensureSupportedEnvironment();_ensureStackFrameIsLegit(stackframe);this._get(stackframe.fileName).then(function(source){this._get(_findSourceMappingURL(source)).then(function(map){var lineNumber=stackframe.lineNumber;var columnNumber=stackframe.columnNumber;resolve(_newLocationInfoFromSourceMap(map,stackframe.args,lineNumber,columnNumber))},reject)["catch"](reject)}.bind(this),reject)["catch"](reject)}.bind(this))}}});(function(root,factory){"use strict";if(typeof define==="function"&&define.amd){define("stacktrace",["error-stack-parser","stack-generator","stacktrace-gps","es6-promise"],factory)}else if(typeof exports==="object"){module.exports=factory(require("error-stack-parser"),require("stack-generator"),require("stacktrace-gps"),require("es6-promise"))}else{root.StackTrace=factory(root.ErrorStackParser,root.StackGenerator,root.StackTraceGPS,root.ES6Promise)}})(this,function StackTrace(ErrorStackParser,StackGenerator,StackTraceGPS,ES6Promise){ES6Promise.polyfill();var Promise=ES6Promise.Promise;var _options={filter:function(stackframe){return(stackframe.functionName||"").indexOf("StackTrace$$")===-1&&(stackframe.functionName||"").indexOf("ErrorStackParser$$")===-1&&(stackframe.functionName||"").indexOf("StackTraceGPS$$")===-1&&(stackframe.functionName||"").indexOf("StackGenerator$$")===-1}};function _merge(first,second){var target={};[first,second].forEach(function(obj){for(var prop in obj){if(obj.hasOwnProperty(prop)){target[prop]=obj[prop]}}return target});return target}function _isShapedLikeParsableError(err){return err.stack||err["opera#sourceloc"]}return{get:function StackTrace$$get(opts){try{throw new Error}catch(err){if(_isShapedLikeParsableError(err)){return this.fromError(err,opts)}else{return this.generateArtificially(opts)}}},fromError:function StackTrace$$fromError(error,opts){opts=_merge(_options,opts);return new Promise(function(resolve){var stackframes=ErrorStackParser.parse(error);if(typeof opts.filter==="function"){stackframes=stackframes.filter(opts.filter)}resolve(Promise.all(stackframes.map(function(sf){return new Promise(function(resolve){function resolveOriginal(_){resolve(sf)}new StackTraceGPS(opts).pinpoint(sf).then(resolve,resolveOriginal)["catch"](resolveOriginal)})})))}.bind(this))},generateArtificially:function StackTrace$$generateArtificially(opts){opts=_merge(_options,opts);var stackFrames=StackGenerator.backtrace(opts);if(typeof opts.filter==="function"){stackFrames=stackFrames.filter(opts.filter)}return Promise.resolve(stackFrames)},instrument:function StackTrace$$instrument(fn,callback,errback,thisArg){if(typeof fn!=="function"){throw new Error("Cannot instrument non-function object")}else if(typeof fn.__stacktraceOriginalFn==="function"){return fn}var instrumented=function StackTrace$$instrumented(){try{this.get().then(callback,errback)["catch"](errback);fn.apply(thisArg||this,arguments)}catch(e){if(_isShapedLikeParsableError(e)){this.fromError(e).then(callback,errback)["catch"](errback)}throw e}}.bind(this);instrumented.__stacktraceOriginalFn=fn;return instrumented},deinstrument:function StackTrace$$deinstrument(fn){if(typeof fn!=="function"){throw new Error("Cannot de-instrument non-function object")}else if(typeof fn.__stacktraceOriginalFn==="function"){return fn.__stacktraceOriginalFn}else{return fn}}}});
//@ sourceMappingURL=stacktrace.js.map